require "cs2lua__namespaces"; 

UiScrollInfo = {
	-------------------------------
	-------- class methods --------
	-------------------------------
	__new_object = function(...)
		local __cs2dsl_newobj;
		__cs2dsl_newobj = newobject(UiScrollInfo, nil, nil, "ctor", 0, nil, ...);
		return __cs2dsl_newobj;
	end,

	cctor = function()
		UiScrollInfo.__cctor();
	end,

	__cctor = function()
		if UiScrollInfo.__cctor_called then 
			return;
		else
			UiScrollInfo.__cctor_called = true;
		end;
	end,

	-------------------------------
	-------- class fields --------
	-------------------------------
	c_MinTextHeight = 24.00000000,
	__cctor_called = false,

	-------------------------------
	------ instance methods -------
	-------------------------------
	Init = function(this, obj, behaviour)
		local __cs2lua_func_info = luainitialize();
		luapcall(UiScrollInfo.__ori_Init, this, __cs2lua_func_info, obj, behaviour);
		__cs2lua_func_info = luafinalize(__cs2lua_func_info);
	end,
	__ori_Init = function(this, __cs2lua_func_info, obj, behaviour)
		this.m_GameObject = obj;
		this.m_Item = UnityEngine.Resources.Load__String(luastrtocsstr("UI/Image"));
		this.m_RectTransform = typeas(this.m_GameObject.transform, UnityEngine.RectTransform, TypeKind.Class);
		local viewObj;
		viewObj = this.m_RectTransform.parent.parent.gameObject;
		this.m_ScrollRect = viewObj:GetComponent__Type(UnityEngine.UI.ScrollRect);
		local rectTrans;
		rectTrans = typeas(this.m_RectTransform.parent.parent, UnityEngine.RectTransform, TypeKind.Class);
		this.m_Top = 0;
		this.m_Width = getexterninstancestructmember(SymbolKind.Property, rectTrans, UnityEngine.RectTransform, "rect").width;
		this.m_Height = getexterninstancestructmember(SymbolKind.Property, this.m_RectTransform, UnityEngine.RectTransform, "rect").height;
	end,

	Update = function(this)
		local time;
		time = UnityEngine.Time.time;
		if ((this.m_ScrollToEndTime + 1) >= time) then 
			this.m_ScrollRect.verticalScrollbar.value = 0;
		end;
	end,

	Call = function(this, name, ...)
		local args;
		args = wrapparams({...}, System.Object, TypeKind.Class);
		if stringisequal(name, "PushInfo") then 
			local info;
			info = typeas(args[1], System.String, TypeKind.Class);
			if (not stringisequal(nil, info)) then 
				UiScrollInfo.PushInfo(this, info);
			end;
		end;
	end,

	PushInfo = function(this, text)
		local __cs2lua_func_info = luainitialize();
		luapcall(UiScrollInfo.__ori_PushInfo, this, __cs2lua_func_info, text);
		__cs2lua_func_info = luafinalize(__cs2lua_func_info);
	end,
	__ori_PushInfo = function(this, __cs2lua_func_info, text)
		if invokeexternoperator(System.Boolean, UnityEngine.Object, "op_Inequality", nil, this.m_Item) then 
			local item;
			item = typeas(UnityEngine.Object.Instantiate__Object(this.m_Item), UnityEngine.GameObject, TypeKind.Class);
			local t;
			t = item.transform:Find(luastrtocsstr("Text"));
			if invokeexternoperator(System.Boolean, UnityEngine.Object, "op_Inequality", nil, t) then 
				item.transform:SetParent__Transform__Boolean(this.m_GameObject.transform, false);
				local bkg;
				bkg = item:GetComponent__Type(UnityEngine.UI.Image);
				local rectTrans;
				rectTrans = typeas(bkg.transform, UnityEngine.RectTransform, TypeKind.Class);
				local content;
				content = t.gameObject:GetComponent__Type(UnityEngine.UI.Text);
				local rectTrans2;
				rectTrans2 = typeas(t.gameObject.transform, UnityEngine.RectTransform, TypeKind.Class);
				local dw;
				dw = 16;
				local dh;
				dh = 6;
				if invokeexternoperator(System.Boolean, UnityEngine.Object, "op_Inequality", nil, content) then 
					local w;
					local h;
					local __invoke_52_20_52_131;
					__invoke_52_20_52_131,w,h = UiScrollInfo.CalcBounds(this, text, content, new_vector2(__cs2lua_func_info, nil, getexterninstancestructmember(SymbolKind.Property, rectTrans, UnityEngine.RectTransform, "rect").width, getexterninstancestructmember(SymbolKind.Property, rectTrans, UnityEngine.RectTransform, "rect").height), (this.m_Width - dw), __cs2lua_out, __cs2lua_out);
					if (h < 24.00000000) then 
						h = 24.00000000;
					end;
					content.text = text;
					rectTrans.localPosition = new_vector3(__cs2lua_func_info, nil, 0, this.m_Top, 0);
					rectTrans.sizeDelta = new_vector2(__cs2lua_func_info, nil, (this.m_Width - dw), (h + dh));
					this.m_Top = (this.m_Top - (h + dh));
					this.m_RectTransform.localPosition = new_vector3(__cs2lua_func_info, nil, 0, 0, 0);
					this.m_RectTransform.sizeDelta = new_vector2(__cs2lua_func_info, nil, getexterninstancestructmember(SymbolKind.Property, this.m_RectTransform, UnityEngine.RectTransform, "sizeDelta").x, (dh - this.m_Top));
				end;
			end;
		end;
		this.m_ScrollRect.verticalScrollbar.value = 0;
		this.m_ScrollToEndTime = UnityEngine.Time.time;
	end,

	CalcBounds = function(this, text, content, size, maxWidth, width, height)
		local __cs2lua_func_info = luainitialize();
		local __retval_0, __retval_1, __retval_2, __retval_3 = luapcall(UiScrollInfo.__ori_CalcBounds, this, __cs2lua_func_info, text, content, size, maxWidth, width, height);
		__cs2lua_func_info = luafinalize(__cs2lua_func_info);
		if not __retval_0 then
			lualog("{0}", __retval_1);
			__retval_1 = false;
		end;
		return __retval_1, __retval_2, __retval_3;
	end,
	__ori_CalcBounds = function(this, __cs2lua_func_info, text, content, size, maxWidth, width, height)
		local __method_ret_69_4_101_5;
		local ret;
		ret = false;
		size.x = maxWidth;
		width = 0;
		height = 0;
		local lines;
		lines = callbasicvalue(text, false, System.String, "Split__A_Char", wrapchar("\n", 0x0A));
		local lineCt;
		lineCt = getbasicvalue(lines, false, System.Array, "Length");
		local i;
		i = 0;
		while (i < lineCt) do
			local txt;
			txt = callbasicvalue(lines[(i + 1)], false, System.String, "Trim__A_Char", wrapchar("\r", 0x0D));
			local textSetting;
			textSetting = callexterninstancereturnstruct(content, UnityEngine.UI.Text, "GetGenerationSettings", wrap_vector2(__cs2lua_func_info, size));
			textSetting.verticalOverflow = 1;
			textSetting.horizontalOverflow = 0;
			textSetting.updateBounds = true;
			local generator;
			generator = newexternobject(UnityEngine.TextGenerator, nil, nil, "ctor", 0, nil);
			local pw;
			pw = generator:GetPreferredWidth(txt, wrapexternstructargument(textSetting, UnityEngine.TextGenerationSettings, OperationKind.LocalReference, SymbolKind.Local));
			if generator:Populate(txt, wrapexternstructargument(textSetting, UnityEngine.TextGenerationSettings, OperationKind.LocalReference, SymbolKind.Local)) then 
				local w;
				w = getexterninstancestructmember(SymbolKind.Property, generator, UnityEngine.TextGenerator, "rectExtents").width;
				local h;
				h = getexterninstancestructmember(SymbolKind.Property, generator, UnityEngine.TextGenerator, "rectExtents").height;
				if (w > pw) then 
					w = pw;
				end;
				if (width < w) then 
					width = w;
				end;
				height = (height + h);
				ret = true;
			end;
			i = (i + 1);
		end;
		__method_ret_69_4_101_5 = ret;
		return __method_ret_69_4_101_5, width, height;
	end,

	ctor = function(this)
		UiScrollInfo.__ctor(this);
	end,

	__ctor = function(this)
		if this.__ctor_called then 
			return;
		else
			this.__ctor_called = true;
		end;
	end,
	-------------------------------
	------ instance fields -------
	-------------------------------
	__init_obj_fields = function(this)
		rawset(this, "m_Top", 0);
		rawset(this, "m_Width", 0);
		rawset(this, "m_Height", 2048);
		rawset(this, "m_ScrollToEndTime", 0);
		rawset(this, "__ctor_called", false);
	end,

	-------------------------------
	--- define class and object ---
	-------------------------------
	__define_class = function()
		Utility.Warn("UiScrollInfo::__define_class begin");

		local class = UiScrollInfo;
		local obj_methods = {
			Init = rawget(class, "Init"),
			Update = rawget(class, "Update"),
			Call = rawget(class, "Call"),
			PushInfo = rawget(class, "PushInfo"),
			CalcBounds = rawget(class, "CalcBounds"),
			ctor = rawget(class, "ctor"),
			__ctor = rawget(class, "__ctor"),
		};
		local tmp_obj_method = nil;

		local __defineclass_return = defineclass(nil, "UiScrollInfo", "UiScrollInfo", class, obj_methods, false, false);
		Utility.Warn("UiScrollInfo::__define_class end");
		return __defineclass_return;
	end,

	-------------------------------
	--------- fields info ---------
	-------------------------------
	__class_fields = {
		c_MinTextHeight = true,
		__cctor_called = true,
	},

	__obj_fields = {
		m_Item = true,
		m_GameObject = true,
		m_RectTransform = true,
		m_ScrollRect = true,
		m_Top = true,
		m_Width = true,
		m_Height = true,
		m_ScrollToEndTime = true,
		__ctor_called = true,
	},

	-------------------------------
	-------- metadata info --------
	-------------------------------
	__interfaces = {
		"ITickPlugin",
	},
	__method_info = {
		PushInfo = {
			private = true,
		},
		CalcBounds = {
			private = true,
		},
		ctor = {
			ctor = true,
		},
	},
};


require "cs2lua__syslib";
require "cs2lua__externenums";
require "cs2lua__interfaces";
settempmetatable(UiScrollInfo);
